---
import { ClientRouter } from "astro:transitions";
import prisma from "../lib/prisma";

interface Props {
    title: string;
    description?: string;
}

const {
    title,
    description = "Reserva tu experiencia de cuidado automotriz premium.",
} = Astro.props;

const settings = await prisma.settings.findUnique({
    where: { id: "main" },
});

const businessName = settings?.businessName || "AutoSpa Premium";
---

<!doctype html>
<html lang="es" class="scroll-smooth">
    <head>
        <meta charset="UTF-8" />
        <meta name="description" content={description} />
        <meta name="viewport" content="width=device-width" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <meta name="generator" content={Astro.generator} />

        <!-- Google Fonts: Playfair Display & Manrope -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;1,400&display=swap"
            rel="stylesheet"
        />

        <title>{title}</title>
        <ClientRouter />
    </head>
    <body
        class="bg-luxury-black text-white font-sans antialiased selection:bg-primary-500 selection:text-white flex flex-col min-h-screen"
    >
        <div class="flex-1">
            <slot />
        </div>

        <footer class="bg-black/50 border-t border-white/5 py-12 px-6">
            <div
                class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-8"
            >
                <!-- Brand & Legal -->
                <div class="text-center md:text-left">
                    <h2 class="text-xl font-serif text-primary-400 mb-2">
                        {businessName}
                    </h2>
                    <p class="text-sm text-gray-500 mb-4">
                        © 2026 All Rights Reserved
                    </p>

                    <div
                        class="flex flex-col md:flex-row gap-4 md:gap-8 text-gray-400 text-sm font-light mb-6"
                    >
                        <span
                            >{
                                settings?.address ||
                                    "Av. Mariscal López 1234, Asunción"
                            }</span
                        >
                        <span
                            >{settings?.whatsappNumber || "+595991234567"}</span
                        >
                    </div>

                    <div
                        class="flex flex-wrap justify-center md:justify-start gap-4 text-xs font-medium text-gray-400"
                    >
                        <a
                            href="/legal/terminos"
                            class="hover:text-primary-400 transition-colors"
                            >Términos y Condiciones</a
                        >
                        <a
                            href="/legal/privacidad"
                            class="hover:text-primary-400 transition-colors"
                            >Política de Privacidad</a
                        >
                        <a
                            href="/legal/aviso"
                            class="hover:text-primary-400 transition-colors"
                            >Aviso Legal</a
                        >
                    </div>
                </div>

                <!-- Social Media -->
                <div class="flex items-center gap-6">
                    {
                        settings?.instagramUrl && (
                            <a
                                href={settings.instagramUrl}
                                target="_blank"
                                rel="noopener noreferrer"
                                class="text-gray-400 hover:text-primary-400 transition-colors"
                                aria-label="Instagram"
                            >
                                <svg
                                    class="w-6 h-6"
                                    fill="currentColor"
                                    viewBox="0 0 24 24"
                                >
                                    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 1.166.054 1.8.249 2.223.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.223.058 1.266.07 1.646.07 4.85s-.012 3.584-.07 4.85c-.054 1.166-.249 1.8-.415 2.223-.217.562-.477.96-.896 1.382-.42.419-.819.679-1.381.896-.422.164-1.057.36-2.223.413-1.266.058-1.646.07-4.85.07s-3.584-.012-4.85-.07c-1.166-.054-1.8-.249-2.223-.415-.562-.217-.96-.477-1.382-.896-.419-.42-.679-.819-.896-1.381-.164-.422-.36-1.057-.413-2.223-.058-1.266-.07-1.646-.07-4.85s.012-3.584.07-4.85c.054-1.166.249-1.8.415-2.223.217-.562.477-.96.896-1.382.42-.419.819-.679 1.381-.896.422-.164 1.057.36 2.223.413 1.266.058 1.646.07 4.85.07zm0-2.163c-3.259 0-3.667.014-4.947.072-1.277.057-2.148.258-2.911.554-.79.306-1.459.717-2.126 1.384-.667.667-1.078 1.335-1.384 2.126-.296.763-.497 1.634-.554 2.911-.058 1.28-.072 1.688-.072 4.947s.014 3.667.072 4.947c.057 1.277.258 2.148.554 2.911.306.79.717 1.459 1.384 2.126.667.667 1.335 1.078 2.126 1.384.763.296 1.634.497 2.911.554 1.28.058 1.688.072 4.947.072s3.667-.014 4.947-.072c1.277-.057 2.148-.258 2.911-.554.79-.306 1.459-.717 2.126-1.384.667-.667 1.078-1.335 1.384-2.126.296-.763.497-1.634.554-2.911.058-1.28.072-1.688.072-4.947s-.014-3.667-.072-4.947c-.057-1.277-.258-2.148-.554-2.911-.306-.79-.717-1.459-1.384-2.126-.667-.667-1.335-1.078-2.126-1.384-.763-.296-1.634-.497-2.911-.554-1.28-.058-1.688-.072-4.947-.072zM12 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.162 6.162 6.162 6.162-2.759 6.162-6.162-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.791-4-4s1.791-4 4-4 4 1.791 4 4-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z" />
                                </svg>
                            </a>
                        )
                    }
                    {
                        settings?.facebookUrl && (
                            <a
                                href={settings.facebookUrl}
                                target="_blank"
                                rel="noopener noreferrer"
                                class="text-gray-400 hover:text-primary-400 transition-colors"
                                aria-label="Facebook"
                            >
                                <svg
                                    class="w-6 h-6"
                                    fill="currentColor"
                                    viewBox="0 0 24 24"
                                >
                                    <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.469h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.234 2.686.234v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.469h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
                                </svg>
                            </a>
                        )
                    }
                    {
                        settings?.tiktokUrl && (
                            <a
                                href={settings.tiktokUrl}
                                target="_blank"
                                rel="noopener noreferrer"
                                class="text-gray-400 hover:text-primary-400 transition-colors"
                                aria-label="TikTok"
                            >
                                <svg
                                    class="w-6 h-6"
                                    fill="currentColor"
                                    viewBox="0 0 24 24"
                                >
                                    <path d="M12.53.02C13.84 0 15.14.01 16.44 0c.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.59-1.62-.93-.01 2.92.01 5.84-.02 8.75-.03 1.4-.54 2.79-1.35 3.94-1.31 1.92-3.58 3.17-5.91 3.21-1.43.08-2.86-.31-4.08-1.03-2.02-1.19-3.44-3.37-3.65-5.71-.02-.5-.03-1-.01-1.49.18-1.9 1.12-3.72 2.58-4.96 1.66-1.44 3.98-2.13 6.15-1.72.02 1.48-.04 2.96-.04 4.44-1.13-.32-2.43-.2-3.41.49-.6.41-1.01 1.03-1.13 1.75-.1.66-.04 1.33.18 1.96.22.64.67 1.18 1.25 1.54.85.53 1.9.61 2.85.34 1.15-.31 2.03-1.28 2.23-2.42.06-1.79.02-3.58.04-5.38V0z" />
                                </svg>
                            </a>
                        )
                    }
                </div>
            </div>
        </footer>
    </body>
</html>

<style is:global>
    /* Custom Scrollbar for Luxury Feel */
    ::-webkit-scrollbar {
        width: 8px;
    }
    ::-webkit-scrollbar-track {
        background: #050505;
    }
    ::-webkit-scrollbar-thumb {
        background: #333;
        border-radius: 4px;
    }
    ::-webkit-scrollbar-thumb:hover {
        background: #555;
    }

    /* Global utility to prevent overscroll bounce showing white backgrounds */
    html {
        background-color: #050505;
    }
</style>
